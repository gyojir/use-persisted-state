var e,t=require("react"),n=(e=require("@use-it/event-listener"))&&"object"==typeof e&&"default"in e?e.default:e,r={},u=function(e,t,n){return r[e]||(r[e]={callbacks:[],value:n}),r[e].callbacks.push(t),{deregister:function(){var n=r[e].callbacks,u=n.indexOf(t);u>-1&&n.splice(u,1)},emit:function(n){r[e].value!==n&&(r[e].value=n,r[e].callbacks.forEach(function(e){t!==e&&e(n)}))}}};module.exports=function(e,r){if(void 0===r&&(r=global.localStorage),r){var c=function(e){return{get:function(t,n){var r=e.getItem(t);return null===r?"function"==typeof n?n():n:JSON.parse(r)},set:function(t,n){e.setItem(t,JSON.stringify(n))}}}(r);return function(r){return function(e,r,c){var a=c.get,i=c.set,f=t.useRef(null),o=t.useState(function(){return a(r,e)}),l=o[0],s=o[1];n("storage",function(e){if(e.key===r){var t=JSON.parse(e.newValue);l!==t&&s(t)}}),t.useEffect(function(){return f.current=u(r,s,e),function(){f.current.deregister()}},[]);var v=t.useCallback(function(e){s(function(t){var n="function"==typeof e?e(t):e;return i(r,n),f.current.emit(n),n})},[i,r]);return[l,v]}(r,e,c)}}return t.useState};
